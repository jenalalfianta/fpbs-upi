---
import { injectInlineCarousel } from '@/lib/inlineCarousel.js';

const { prodiData, activeTab } = Astro.props;

const sections = prodiData?.data?.sections ?? {};
const menu = prodiData?.data?.menu ?? [];

function getSectionTitle(key, section) {
  return section?.title || (menu.find((item) => item.id === key)?.label) || key;
}

function renderContent(html) {
  // proses :::carousel ... ::: jadi HTML siap pakai
  return injectInlineCarousel(html ?? '');
}
---

<section class="bg-white dark:bg-gray-900 pt-0 md:pt-0 pb-16 md:pb-20 px-4 md:px-6">
  <div class="max-w-6xl mx-auto space-y-12 prodi-content pt-2">
    {Object.entries(sections).map(([key, section]) => (
      <div id={key} data-content class={activeTab === key ? 'block' : 'hidden'}>
        {section?.externalLink ? (
          <a
            href={section.externalLink}
            target="_blank"
            rel="noopener noreferrer"
            class="text-purple-700 hover:underline"
          >
            View Detail
          </a>
        ) : (
          <div
            class="text-gray-800 dark:text-gray-100 leading-relaxed"
            set:html={renderContent(section?.content)}
          />
        )}
      </div>
    ))}
  </div>
</section>

<style>
.prodi-content > *:first-child {
  margin-top: 0;
  padding-top: 0;
}
</style>
