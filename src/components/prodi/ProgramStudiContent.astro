---
import { injectInlineCarousel } from '@/lib/inlineCarousel.js';

const { prodiData, activeTab } = Astro.props;

const sections = prodiData?.data?.sections ?? {};
const menu = prodiData?.data?.menu ?? [];

function getSectionTitle(key, section) {
  return section?.title || (menu.find((item) => item.id === key)?.label) || key;
}
---
<section class="bg-white dark:bg-gray-900 pt-0 md:pt-0 pb-16 md:pb-20 px-4 md:px-6">
  <div class="max-w-6xl mx-auto space-y-12 prodi-content pt-2">
    {Object.entries(sections).map(([key, section]) => {
      // Suntikkan carousel untuk setiap section content (ID & EN)
      const raw = section?.content ?? '';
      const withCarousel = injectInlineCarousel(raw);

      return (
        <div id={key} data-content class={activeTab === key ? 'block' : 'hidden'}>
          {section?.externalLink ? (
            <a
              href={section.externalLink}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 text-purple-700 dark:text-purple-300 hover:underline"
            >
              Lihat Detail
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 3h7m0 0v7m0-7L10 14" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7v12a2 2 0 0 0 2 2h12" />
              </svg>
            </a>
          ) : (
            <div class="text-gray-800 dark:text-gray-100 leading-relaxed" set:html={withCarousel} />
          )}
        </div>
      );
    })}
  </div>
</section>

<style>
.prodi-content > *:first-child {
  margin-top: 0;
  padding-top: 0;
}
</style>
